import pandas as pd

import datakicker as dk

# import LatLon

data = dk.getChartData('ZOd9a')


def addMarkers(data, filename):
    print(data)
    admin = pd.read_csv(filename)
    markers = []
    for site in admin.iterrows():
        print(site)
        arrow = {'enabled': True}
        id = site[1]['SiteCode']
        bikex = {'id': 'bicycle',
                 'path': 'M625 700l-25-50 100-37 0-113-350 0 0 50 50 0 0 25c0 12-13 25-25 25l-125 0c-25 0-25-25-25-25l0-25 75 0 0-50-53-106c-15 3-31 6-47 6-110 0-200-89-200-200s90-200 200-200 200 90 200 200c0 0 50 0 75 0s25 25 25 25c5 74 43 131 92 169 34 26 71 42 108 50l0-52c-86-22-150-99-150-192 0-110 90-200 200-200s200 90 200 200c0 91-62 167-145 191l-55 109 0 125c0 15-12 31-25 36z m-275-250l225 0c-50-25-125-150-125-200l-58 0c-12 49-41 90-83 117z m-150-125c69 0 125-56 125-125s-56-125-125-125-125 56-125 125 56 125 125 125z m550 0c69 0 125-56 125-125s-56-125-125-125-125 56-125 125 56 125 125 125z',
                 'horiz-adv-x': 950, 'height': 700, 'width': 950}
        bike = {'id': 'bicycle',
                'path': 'M625 700l-25-50 100-37 0-113-350 0 0 50 50 0 0 25c0 12-13 25-25 25l-125 0c-25 0-25-25-25-25l0-25 75 0 0-50-53-106c-15 3-31 6-47 6-110 0-200-89-200-200s90-200 200-200 200 90 200 200c0 0 50 0 75 0s25 25 25 25c5 74 43 131 92 169 34 26 71 42 108 50l0-52c-86-22-150-99-150-192 0-110 90-200 200-200s200 90 200 200c0 91-62 167-145 191l-55 109 0 125c0 15-12 31-25 36z m-275-250l225 0c-50-25-125-150-125-200l-58 0c-12 49-41 90-83 117z m-150-125c69 0 125-56 125-125s-56-125-125-125-125 56-125 125 56 125 125 125z m550 0c69 0 125-56 125-125s-56-125-125-125-125 56-125 125 56 125 125 125z',
                'horiz-adv-x': 950, }
        footx = {'id': 'school',
                 'path': 'M638 800c-49 0-88-39-88-87s39-88 88-88 87 39 87 88-39 87-87 87z m-400-100c-49 0-88-39-88-87s39-88 88-88 87 39 87 88-39 87-87 87z m462-100c-19 0-49-7-75-25l-162-116c-45-31-4-86 37-59l106 70s70-150 44-220c-1-2-2-4-2-6l-109-291c-12-33 12-53 36-53 16 0 31 10 39 28l136 322s25-150 125-150c60 0 104 0 138 0 37 0 37 38 37 38s0 37-37 37c-25 0-88 0-113 0-53 0-50 80-50 125 0 75-50 200-50 200l150-100c45-30 85 23 41 56l-166 119c-30 22-40 25-75 25 0 0-25 0-50 0z m-525-100c-25 0-37-12-50-25l-106-106c-14-14-19-26-19-44 0-25 38-37 59-16l91 91c50 0 69-125 50-175l-75-200c-21-55 57-72 75-25l75 200s25-50 75-50l150 0c50 0 50 75 0 75l-125 0c-25 0-25 50-25 75 0 100-50 200-100 200z',
                 'horiz-adv-x': 1050, 'height': 700, 'width': 1050}
        foot = {'id': 'school',
                'path': 'M638 800c-49 0-88-39-88-87s39-88 88-88 87 39 87 88-39 87-87 87z m-400-100c-49 0-88-39-88-87s39-88 88-88 87 39 87 88-39 87-87 87z m462-100c-19 0-49-7-75-25l-162-116c-45-31-4-86 37-59l106 70s70-150 44-220c-1-2-2-4-2-6l-109-291c-12-33 12-53 36-53 16 0 31 10 39 28l136 322s25-150 125-150c60 0 104 0 138 0 37 0 37 38 37 38s0 37-37 37c-25 0-88 0-113 0-53 0-50 80-50 125 0 75-50 200-50 200l150-100c45-30 85 23 41 56l-166 119c-30 22-40 25-75 25 0 0-25 0-50 0z m-525-100c-25 0-37-12-50-25l-106-106c-14-14-19-26-19-44 0-25 38-37 59-16l91 91c50 0 69-125 50-175l-75-200c-21-55 57-72 75-25l75 200s25-50 75-50l150 0c50 0 50 75 0 75l-125 0c-25 0-25 50-25 75 0 100-50 200-100 200z',
                'horiz-adv-x': 1050}
        if site[1]['title'][7:11] == 'Velo':
            icon = bike
        else:
            icon = foot
        title = site[1]['stationstring']
        link = site[1]['url']
        if site[1]['ignore'] != 1:
            coord = site[1]['coordinates'].split(',')
            coordinates = [coord[1], coord[0]]
            thismarker = {'id': id, 'type': 'point', 'title': '', 'icon': icon, 'coordinates': coordinates,
                          'tooltip': {'enabled': True, 'text': '<a href=' + link + '>' + title + '</a>'}}
            markers.append(thismarker)
            print(thismarker)
    data['markers'] = markers
    dk.updateMarkers('ZOd9a', data)


addMarkers(data, 'rollingavg_3m_chartadmin.csv')
